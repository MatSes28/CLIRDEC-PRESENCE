ðŸ“Œ Final Logic of CLIRDEC: PRESENCE

1. System Setup
	â€¢	Each classroom has 1 ESP32-S3 connected to:
	â€¢	RFID reader (RC522) â†’ for student ID tap.
	â€¢	HC-SR04 ultrasonic sensor(s) â†’ for body presence validation (entry/exit).
	â€¢	The ESP32-S3 communicates either via:
	â€¢	USB HID mode (acts like a keyboard typing RFID IDs into the web system), OR
	â€¢	Wi-Fi mode (sends data via API to the Django/MySQL backend server).
	â€¢	The Web Dashboard (Admin/Faculty system) holds:
	â€¢	Class schedules
	â€¢	Student database
	â€¢	Attendance rules
	â€¢	Notification system.

â¸»

2. Attendance Session Activation
	â€¢	The dashboard controls the time (based on class schedules uploaded by Admin/Faculty).
	â€¢	At the start of class:
	â€¢	Tap-In mode is ON.
	â€¢	Tap-Out mode is OFF.
	â€¢	After the class ends:
	â€¢	Tap-In mode is disabled.
	â€¢	Tap-Out mode is enabled (for proper exit logging).

â¸»

3. Student Entry (One-Tap, One-Entry Rule)
	1.	Student taps Smart RFID ID.
	2.	ESP32-S3:
	â€¢	Reads UID.
	â€¢	Temporarily locks exit sensor (to avoid ghost taps).
	â€¢	Waits for entry detection from the ultrasonic sensor.
	3.	If sensor detects body entering within timeout (e.g., 5â€“7 seconds):
	â€¢	System logs Valid Entry.
	â€¢	Marks student Present (if within 15 mins of start).
	â€¢	Marks Late (if within 15 minsâ€“60% of class time).
	â€¢	Marks Absent if after 60%.
	â€¢	Re-enables exit sensor for future use.
	4.	If no detection within timeout:
	â€¢	System flags Ghost Tap.
	â€¢	Student can re-tap to retry.

â¸»

4. Student Exit (Breaks/Restroom or End of Class)
	1.	Student approaches exit door.
	2.	Exit sensor activates â†’ student movement detected.
	3.	System checks:
	â€¢	If student tapped out â†’ log Valid Exit.
	â€¢	If sensor detects exit but no tap â†’ log Discrepancy (possible ghost exit).
	4.	If student returns and taps again â†’ counted properly (entry restored).

â¸»

5. Discrepancy Handling
	â€¢	System compares RFID logs vs Sensor logs:
	â€¢	If RFID tap exists but no body detected â†’ Ghost Attendance flagged.
	â€¢	If sensor detects movement but no RFID tap â†’ Missed Tap flagged.
	â€¢	Discrepancies are logged in the database and shown on dashboard for admin review.

â¸»

6. End of Session
	â€¢	At official end time:
	â€¢	Tap-in disabled, tap-out enabled.
	â€¢	Students must tap-out to complete attendance cycle.
	â€¢	Final attendance status stored in MySQL:
	â€¢	Present, Late, Absent, or Flagged.
	â€¢	System generates daily reports (faculty view).
	â€¢	Email alerts auto-sent to parents if student is Absent or has suspicious/flagged logs.

â¸»

7. Roles & Access
	â€¢	Admin â†’ Manage users, schedules, classrooms, view all reports, investigate discrepancies.
	â€¢	Faculty â†’ View own class logs, generate reports, monitor student engagement.
	â€¢	Students â†’ Use Smart ID, can request attendance correction if flagged.
	â€¢	Parents â†’ Receive email alerts on absences.

â¸»

âœ… Key Advantages of Final Logic
	â€¢	Prevents ghost attendance (requires both tap + sensor validation).
	â€¢	Prevents cutting classes (tap-out required; discrepancies logged).
	â€¢	Fully time-based (controlled by dashboard schedules).
	â€¢	Flexible (works via USB HID or Wi-Fi API backend).
	â€¢	Scalable across classrooms (one ESP32-S3 per room).

â¸»